package chessbase

var EMPTY = 0
var W_QUEEN = 1
var W_KNIGHT = 2
var W_BISHOP = 3
var W_ROOK = 4

var B_QUEEN = 5
var B_KNIGHT = 6
var B_BISHOP = 7
var B_ROOK = 8

var W_KING = 9
var B_KING = 10
var W_PAWN = 11
var B_PAWN = 12

/*
MASK_IS_GAME = int('00000001', 2)
MASK_MARKED_FOR_DELETION = int('10000000', 2)
MASK_DAY = int('000000000000000000011111', 2)
MASK_MONTH = int('000000000000000111100000', 2)
MASK_YEAR = int('111111111111111000000000', 2)
*/

var MASK_IS_GAME = 0b00000001
var MASK_MARKED_FOR_DELETION = 0b10000000
var MASK_DAY = 0b000000000000000000011111
var MASK_MONTH = 0b000000000000000111100000
var MASK_YEAR = 0b111111111111111000000000

var MASK_START_WITH_INITIAL uint32 = 0x40000000
var MASK_IS_ENCODED uint32 = 0x80000000

// some games have this bit set, e.g.
// Giffard, Nicolas vs Martsynovskaya, Marina
// only few games in mega have this flag
// game is then obfuscated in a different way, how to decode?
var MASK_SPECIAL_ENCODING uint32 = 0x4000000
var MASK_GAME_LEN uint32 = 0x00FFFFFF
var MASK_IS_960 uint32 = 0x00A000000

var MASK_EP_FILE = 0x7
var MASK_TURN = 0x10

var MASK_WHITE_CASTLE_LONG = 1
var MASK_WHITE_CASTLE_SHORT = 2
var MASK_BLACK_CASTLE_LONG = 4
var MASK_BLACK_CASTLE_SHORT = 8

var SQN = [][]string{
	{"a1", "a2", "a3", "a4", "a5", "a6", "a7", "a8"},
	{"b1", "b2", "b3", "b4", "b5", "b6", "b7", "b8"},
	{"c1", "c2", "c3", "c4", "c5", "c6", "c7", "c8"},
	{"d1", "d2", "d3", "d4", "d5", "d6", "d7", "d8"},
	{"e1", "e2", "e3", "e4", "e5", "e6", "e7", "e8"},
	{"f1", "f2", "f3", "f4", "f5", "f6", "f7", "f8"},
	{"g1", "g2", "g3", "g4", "g5", "g6", "g7", "g8"},
	{"h1", "h2", "h3", "h4", "h5", "h6", "h7", "h8"},
}

var PIECE_MAP = map[int]string{
	1:  "Q",
	2:  "N",
	3:  "B",
	4:  "R",
	5:  "Q",
	6:  "N",
	7:  "B",
	8:  "R",
	9:  "K",
	10: "K",
	11: "",
	12: "",
}

var ABS_TO_XY = []Coord{
	{0, 0}, {0, 1}, {0, 2}, {0, 3}, {0, 4}, {0, 5}, {0, 6}, {0, 7}, // a1 ... a8
	{1, 0}, {1, 1}, {1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 7}, // b1 ... b8
	{2, 0}, {2, 1}, {2, 2}, {2, 3}, {2, 4}, {2, 5}, {2, 6}, {2, 7}, // c1 ... c8
	{3, 0}, {3, 1}, {3, 2}, {3, 3}, {3, 4}, {3, 5}, {3, 6}, {3, 7}, // d1 ... d8
	{4, 0}, {4, 1}, {4, 2}, {4, 3}, {4, 4}, {4, 5}, {4, 6}, {4, 7}, // e1 ... e8
	{5, 0}, {5, 1}, {5, 2}, {5, 3}, {5, 4}, {5, 5}, {5, 6}, {5, 7}, // f1 ... f8
	{6, 0}, {6, 1}, {6, 2}, {6, 3}, {6, 4}, {6, 5}, {6, 6}, {6, 7}, // g1 ... g8
	{7, 0}, {7, 1}, {7, 2}, {7, 3}, {7, 4}, {7, 5}, {7, 6}, {7, 7}, // h1 ... h8
}

var CB_KING_ENC = map[byte]Coord{
	0x49: {0, 1},
	0x39: {1, 1},
	0xD8: {1, 0},
	0x5D: {1, 7},
	0xC2: {0, 7},
	0xB1: {7, 7},
	0xB2: {7, 0},
	0x47: {7, 1},
	0x76: {2, 0},  // castles short
	0xB5: {-2, 0}, // castles long
}

var CB_QUEEN_1_ENC = map[byte]Coord{
	0xA5: {0, 1},
	0xB8: {0, 2},
	0xCB: {0, 3},
	0x53: {0, 4},
	0x7F: {0, 5},
	0x6B: {0, 6},
	0x8D: {0, 7},
	0x79: {1, 0},
	0xBE: {2, 0},
	0xEB: {3, 0},
	0x21: {4, 0},
	0x99: {5, 0},
	0xD2: {6, 0},
	0x57: {7, 0},
	0x4D: {1, 1},
	0xB4: {2, 2},
	0xBF: {3, 3},
	0x62: {4, 4},
	0xBD: {5, 5},
	0x24: {6, 6},
	0x96: {7, 7},
	0xA7: {1, 7},
	0x48: {2, 6},
	0x28: {3, 5},
	0x6E: {4, 4},
	0x2F: {5, 3},
	0x5A: {6, 2},
	0x18: {7, 1},
}

var CB_QUEEN_2_ENC = map[byte]Coord{
	0xE5: {0, 1},
	0x94: {0, 2},
	0x50: {0, 3},
	0x11: {0, 4},
	0xEA: {0, 5},
	0x31: {0, 6},
	0x01: {0, 7},
	0x5C: {1, 0},
	0x95: {2, 0},
	0xCA: {3, 0},
	0xD3: {4, 0},
	0x1D: {5, 0},
	0x7E: {6, 0},
	0xEF: {7, 0},
	0x44: {1, 1},
	0x80: {2, 2},
	0xA0: {3, 3},
	0x1F: {4, 4},
	0x83: {5, 5},
	0x00: {6, 6},
	0x4B: {7, 7},
	0x67: {1, 7},
	0x20: {2, 6},
	0x5B: {3, 5},
	0x2A: {4, 4},
	0x92: {5, 3},
	0xB6: {6, 2},
	0x60: {7, 1},
}

var CB_QUEEN_3_ENC = map[byte]Coord{
	0x1A: {0, 1},
	0x42: {0, 2},
	0x0F: {0, 3},
	0x0D: {0, 4},
	0xB0: {0, 5},
	0xD1: {0, 6},
	0x23: {0, 7},
	0xF0: {1, 0},
	0x7A: {2, 0},
	0x54: {3, 0},
	0x4F: {4, 0},
	0xF4: {5, 0},
	0xA8: {6, 0},
	0x72: {7, 0},
	0xE7: {1, 1},
	0x40: {2, 2},
	0x38: {3, 3},
	0x59: {4, 4},
	0x87: {5, 5},
	0xE8: {6, 6},
	0x6C: {7, 7},
	0x86: {1, 7},
	0x04: {2, 6},
	0xF1: {3, 5},
	0x8C: {4, 4},
	0xCE: {5, 3},
	0x6A: {6, 2},
	0xDB: {7, 1},
}

var CB_ROOK_1_ENC = map[byte]Coord{
	0x4E: {0, 1},
	0xF8: {0, 2},
	0x43: {0, 3},
	0xD7: {0, 4},
	0x63: {0, 5},
	0x9C: {0, 6},
	0xE6: {0, 7},
	0x2E: {1, 0},
	0xC6: {2, 0},
	0x26: {3, 0},
	0x88: {4, 0},
	0x30: {5, 0},
	0x61: {6, 0},
	0x6F: {7, 0},
}

var CB_ROOK_2_ENC = map[byte]Coord{
	0x14: {0, 1},
	0xA9: {0, 2},
	0x68: {0, 3},
	0xEE: {0, 4},
	0xFB: {0, 5},
	0x77: {0, 6},
	0xE2: {0, 7},
	0xA6: {1, 0},
	0x05: {2, 0},
	0x8B: {3, 0},
	0xA1: {4, 0},
	0x98: {5, 0},
	0x32: {6, 0},
	0x52: {7, 0},
}

var CB_ROOK_3_ENC = map[byte]Coord{
	0x81: {0, 1},
	0x82: {0, 2},
	0x9A: {0, 3},
	0x1B: {0, 4},
	0x9D: {0, 5},
	0x0A: {0, 6},
	0x2B: {0, 7},
	0x8F: {1, 0},
	0xCD: {2, 0},
	0xED: {3, 0},
	0x10: {4, 0},
	0x74: {5, 0},
	0x69: {6, 0},
	0xD6: {7, 0},
}

var CB_BISHOP_1_ENC = map[byte]Coord{
	0x02: {1, 1},
	0x97: {2, 2},
	0xE1: {3, 3},
	0x41: {4, 4},
	0xC3: {5, 5},
	0x7C: {6, 6},
	0xE4: {7, 7},
	0x06: {1, 7},
	0xB7: {2, 6},
	0x55: {3, 5},
	0xD9: {4, 4},
	0x2C: {5, 3},
	0xAE: {6, 2},
	0x37: {7, 1},
}

var CB_BISHOP_2_ENC = map[byte]Coord{
	0xF6: {1, 1},
	0x3F: {2, 2},
	0x08: {3, 3},
	0x93: {4, 4},
	0x73: {5, 5},
	0x5E: {6, 6},
	0x78: {7, 7},
	0x35: {1, 7},
	0xF2: {2, 6},
	0x6D: {3, 5},
	0x71: {4, 4},
	0xA2: {5, 3},
	0xF3: {6, 2},
	0x16: {7, 1},
}

var CB_BISHOP_3_ENC = map[byte]Coord{
	0x51: {1, 1},
	0xB9: {2, 2},
	0x45: {3, 3},
	0x3B: {4, 4},
	0x56: {5, 5},
	0x91: {6, 6},
	0xFD: {7, 7},
	0xAB: {1, 7},
	0x66: {2, 6},
	0x3E: {3, 5},
	0x46: {4, 4},
	0xB3: {5, 3},
	0xFC: {6, 2},
	0xC8: {7, 1},
}

var CB_KNIGHT_1_ENC = map[byte]Coord{
	0x58: {2, 1},
	0x3D: {1, 2},
	0xFA: {-1, 2},
	0xE9: {-2, 1},
	0xBA: {-2, -1},
	0xD4: {-1, -2},
	0xDD: {1, -2},
	0x4A: {2, -1},
}

var CB_KNIGHT_2_ENC = map[byte]Coord{
	0xC4: {2, 1},
	0x0E: {1, 2},
	0xFE: {-1, 2},
	0x5F: {-2, 1},
	0x75: {-2, -1},
	0x07: {-1, -2},
	0x89: {1, -2},
	0x34: {2, -1},
}

var CB_KNIGHT_3_ENC = map[byte]Coord{
	0x9B: {2, 1},
	0xC0: {1, 2},
	0xE3: {-1, 2},
	0xA3: {-2, 1},
	0xAC: {-2, -1},
	0xC9: {-1, -2},
	0xEC: {1, -2},
	0x27: {2, -1},
}

var CB_PAWN_A_ENC = map[byte]Coord{
	0x2D: {0, 1},
	0xC1: {0, 2},
	0x8E: {1, 1},
	0xF5: {-1, 1},
}

var CB_PAWN_B_ENC = map[byte]Coord{
	0x64: {0, 1},
	0x17: {0, 2},
	0x70: {1, 1},
	0xA4: {-1, 1},
}

var CB_PAWN_C_ENC = map[byte]Coord{
	0x7B: {0, 1},
	0xDA: {0, 2},
	0xE0: {1, 1},
	0x85: {-1, 1},
}

var CB_PAWN_D_ENC = map[byte]Coord{
	0xC5: {0, 1},
	0x0B: {0, 2},
	0x90: {1, 1},
	0xF9: {-1, 1},
}

var CB_PAWN_E_ENC = map[byte]Coord{
	0x84: {0, 1},
	0xFF: {0, 2},
	0x15: {1, 1},
	0x36: {-1, 1},
}

var CB_PAWN_F_ENC = map[byte]Coord{
	0x09: {0, 1},
	0x9E: {0, 2},
	0x7D: {1, 1},
	0xDE: {-1, 1},
}

var CB_PAWN_G_ENC = map[byte]Coord{
	0xBB: {0, 1},
	0xDF: {0, 2},
	0xBC: {1, 1},
	0x3A: {-1, 1},
}

var CB_PAWN_H_ENC = map[byte]Coord{
	0x12: {0, 1},
	0x33: {0, 2},
	0x13: {1, 1},
	0x19: {-1, 1},
}

var DEOBFUSCATE_2B = []byte{
	0xA2, 0x95, 0x43, 0xF5, 0xC1, 0x3D, 0x4A, 0x6C, //   0 -   7
	0x53, 0x83, 0xCC, 0x7C, 0xFF, 0xAE, 0x68, 0xAD, //   8 -  15
	0xD1, 0x92, 0x8B, 0x8D, 0x35, 0x81, 0x5E, 0x74, //  16 -  23
	0x26, 0x8E, 0xAB, 0xCA, 0xFD, 0x9A, 0xF3, 0xA0, //  24 -  31
	0xA5, 0x15, 0xFC, 0xB1, 0x1E, 0xED, 0x30, 0xEA, //  32 -  39
	0x22, 0xEB, 0xA7, 0xCD, 0x4E, 0x6F, 0x2E, 0x24, //  40 -  47
	0x32, 0x94, 0x41, 0x8C, 0x6E, 0x58, 0x82, 0x50, //  48 -  55
	0xBB, 0x02, 0x8A, 0xD8, 0xFA, 0x60, 0xDE, 0x52, //  56 -  63
	0xBA, 0x46, 0xAC, 0x29, 0x9D, 0xD7, 0xDF, 0x08, //  64 -  71
	0x21, 0x01, 0x66, 0xA3, 0xF1, 0x19, 0x27, 0xB5, //  72 -  79
	0x91, 0xD5, 0x42, 0x0E, 0xB4, 0x4C, 0xD9, 0x18, //  80 -  87
	0x5F, 0xBC, 0x25, 0xA6, 0x96, 0x04, 0x56, 0x6A, //  88 -  95
	0xAA, 0x33, 0x1C, 0x2B, 0x73, 0xF0, 0xDD, 0xA4, //  96 - 103
	0x37, 0xD3, 0xC5, 0x10, 0xBF, 0x5A, 0x23, 0x34, // 104 - 111
	0x75, 0x5B, 0xB8, 0x55, 0xD2, 0x6B, 0x09, 0x3A, // 112 - 119
	0x57, 0x12, 0xB3, 0x77, 0x48, 0x85, 0x9B, 0x0F, // 120 - 127
	0x9E, 0xC7, 0xC8, 0xA1, 0x7F, 0x7A, 0xC0, 0xBD, // 128 - 135
	0x31, 0x6D, 0xF6, 0x3E, 0xC3, 0x11, 0x71, 0xCE, // 136 - 143
	0x7D, 0xDA, 0xA8, 0x54, 0x90, 0x97, 0x1F, 0x44, // 144 - 151
	0x40, 0x16, 0xC9, 0xE3, 0x2C, 0xCB, 0x84, 0xEC, // 152 - 159
	0x9F, 0x3F, 0x5C, 0xE6, 0x76, 0x0B, 0x3C, 0x20, // 160 - 167
	0xB7, 0x36, 0x00, 0xDC, 0xE7, 0xF9, 0x4F, 0xF7, // 168 - 175
	0xAF, 0x06, 0x07, 0xE0, 0x1A, 0x0A, 0xA9, 0x4B, // 176 - 183
	0x0C, 0xD6, 0x63, 0x87, 0x89, 0x1D, 0x13, 0x1B, // 184 - 191
	0xE4, 0x70, 0x05, 0x47, 0x67, 0x7B, 0x2F, 0xEE, // 192 - 199
	0xE2, 0xE8, 0x98, 0x0D, 0xEF, 0xCF, 0xC4, 0xF4, // 200 - 207
	0xFB, 0xB0, 0x17, 0x99, 0x64, 0xF2, 0xD4, 0x2A, // 208 - 215
	0x03, 0x4D, 0x78, 0xC6, 0xFE, 0x65, 0x86, 0x88, // 216 - 223
	0x79, 0x45, 0x3B, 0xE5, 0x49, 0x8F, 0x2D, 0xB9, // 224 - 231
	0xBE, 0x62, 0x93, 0x14, 0xE9, 0xD0, 0x38, 0x9C, // 232 - 239
	0xB2, 0xC2, 0x59, 0x5D, 0xB6, 0x72, 0x51, 0xF8, // 240 - 247
	0x28, 0x7E, 0x61, 0x39, 0xE1, 0xDB, 0x69, 0x80, // 248 - 255
}

var SPECIAL_CODES = []byte{
	0x29, // two byte move follows
	0xDC, // start of variation
	0x0C, //  end of variation
	0x9F, // just skip and continue
}
